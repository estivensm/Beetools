
  <div class="row">
    <div class="col-xl-12">
      <div class="card">
        <div class="card-body">
          <div class="col-md-12 no-padding-left">
            <h3>
              <% if action_name == "new" %>
                Nuevo Documento
                <% else %>
                Editar Documento
              <% end -%>
            </h3>
          </div>
          <br>
          <%= form_with(model: document, local: true) do |form| %>
            <% if document.errors.any? %>
              <div id="error_explanation">
                <h2><%= pluralize(document.errors.count, "error") %> prohibited this document from being saved:</h2>

                <ul>
                <% document.errors.full_messages.each do |message| %>
                  <li><%= message %></li>
                <% end %>
                </ul>
              </div>
            <% end %>
            <div class="row">
            <% if !get_review.exists? %>
              <div class="col-md-4">
                <%= form.label "Procceso" %><br>
                <%= form.select 'proces_id', get_document_type.map { |u| [u.name, u.id] }, {:prompt => 'Tipo de Procceso'},{:class => 'form form-control'}%>
              </div>

              <div class="col-md-4">
                <%= form.label "Tipo de Documento" %><br>
                  <%= form.select 'document_type_id', get_document_type.map { |u| [u.name, u.id] }, {:prompt => 'Tipo de Documento'},{:class => 'form form-control'}%>
              </div>

              <div class="col-md-4">
                <%= form.label "Fecha de Creacion" %><br>
                  <%= form.date_field :create_date, class: "form form-control" %>
              </div>
              <br><br><br><br> 
              <div class="col-md-4">
                <%= form.label "lo Revisa" %><br>
                <%= form.select 'user_review_id', get_user.map { |u| [u.first_name, u.id] }, {:prompt => 'lo Revisa'},{:class => 'form form-control'}%>
              </div>

              <div class="col-md-4">
                <%= form.label "lo Aprueba" %><br>
                <%= form.select 'user_aprove_id', get_user.map { |u| [u.first_name, u.id] }, {:prompt => 'lo Aprueba'},{:class => 'form form-control'}%>
              </div>
            </div>
            <br>
            <% if action_name == "new" %>
              <div class="row">

                <div class="col-md-2 text-center">
                  <%= form.label "Documento Existente" %><br>
                    <input type="checkbox" id="check" class="form form-control">
                </div>

                <div class="col-md-5 form-import" style="display: none;">
                  <label>Importar</label>
                  <%= form.file_field :document_file, class: "form form-control"  %>
                </div>

              </div>
            <% end -%>
            <br>

            <% if action_name == "edit" %>
                  <% @document.document_type.field.each do |docu| %>
                    <div class="col-md-12 no-padding">
                      <label><%= docu.name %></label>
                      <% if docu.field_type == "Texto"%>
                        <% if CreatedField.where(document_id: @document.id, field_id: docu.id).any? %>
                          <% create = CreatedField.where(document_id: @document.id, field_id: docu.id).last %>}
                          <textarea rows="4" name="<%= docu.name %>" cols="50" id="field<%= docu.id %>"><%= create.content %></textarea>
                          <% else %>
                          <textarea rows="4" name="<%= docu.name %>" cols="50" id="field<%= docu.id %>"></textarea>
                        <% end -%>
                      <% end -%>

                      <script type="text/javascript">
                        $('#field<%= docu.id %>').froalaEditor({
                            height: 200,
                            charCounterCount: false,
                            language: 'es',
                            placeholderText: '<%= docu.name %>',
                            toolbarButtons: ['undo', 'redo' , '|', 'bold', 'italic', 'underline', 'strikeThrough', 'subscript', 'superscript', 'outdent', 'indent', 'clearFormatting', 'insertTable', 'html'],
                            toolbarButtonsXS: ['undo', 'redo' , '-', 'bold', 'italic', 'underline']

                        })
                      </script>
                    </div>
                  <% end %>
                <br>
                <div class="col-md-12 no-padding">
                  <%= form.label :header %>
                  <%= form.text_area :header, id: "wysiwyg" %>
                </div>
                <br>
                <div class="col-md-12 no-padding">
                  <%= form.label :footer %>
                  <%= form.text_area :footer, id: "wysiwyg1" %>
                </div>
                <br>
                <div class="col-md-12 no-padding">
                  <%= form.label "Cambiar Descripcion" %>
                  <%= form.text_area :change_description, id: "wysiwyg3" %>
                </div>
              <% end -%>

              <% end %>
            <br>

            <% if action_name == "new" %>
                <%= form.hidden_field :user_id, :value => current_user.id %>
                <%= form.hidden_field :is_last, :value => true %>
                <%= form.hidden_field :review, :value => 1 %>
            <% end -%>

            <div class="col-md-12 modal-footer">
              <%= form.submit "Siguiente", class: "btn btn-success", id: "btn-save" %>
              <%= link_to "Volver", documents_path, class: "btn btn-light" %>
            </div>

          <% end %>
        </div>
      </div>
    </div>
  </div>

  <style type="text/css" media="screen">
    .fr-toolbar{
          border-top: 5px solid #fbcf00 !important;
    }
  </style>

<script type="text/javascript">
jQuery(document).ready(function($) {

    $("#check").change(function() {
    var $input = $( this );

    if ($input.prop("checked") == true){
      console.log('true');
       $(".form-import").fadeIn("show");
    }else {
      $(".form-import").fadeOut("show");
      console.log('false');
    }

  });


});

</script>